from persistencia import save_Car, upload_car
from car import Car
import re

file = 'carros.txt'

def get_car_information():
    print('\nPlease insert your car information below.')
    make = input('Make: ')
    model = input('Model: ')

    while True:
        try:
            year = int(input('Year: '))
            break
        except ValueError:
            print("Invalid year. Please enter a valid integer.")

    plate = input('License Plate: ')
    complaint = input('Complaint: ')
    return Car(make, model, year, plate, complaint)

def listar_car(car):
    print("\nClient list:")
    for i, car in enumerate(car, start=1):
        print(f"{i}. {car}")

def remove_car_by_number(file, number):

    cars = upload_car(file)

    if not cars:
        print("The list is empty")
    elif 1 <= number <= len(cars):
        deleted_car = cars.pop(number - 1)
        save_Car(file, cars)
        print(f"\nCar '{deleted_car}' was successfully deleted.")
    else:
        print(f"\nNumber {number} is incorrect. Try again.")

def update_car_info(car):
    print(f"\nCurrent car information:\n{car}")
    new_make = input("Enter new make (or press Enter to keep current): ")
    new_model = input("Enter new model (or press Enter to keep current): ")
    new_year = input("Enter new year (or press Enter to keep current): ")
    new_complaint = input("Enter new complaint (or press Enter to keep current): ")
    new_plate = input("Enter new license plate (or press Enter to keep current): ")

    if new_make:
        car.make = new_make
    if new_model:
        car.model = new_model
    if new_year:
        try:
            car.year = int(new_year)
        except ValueError:
            print("Invalid year. Please enter a valid integer.")
    if new_complaint:
        car.complaint = new_complaint
    if new_plate:
        car.plate = new_plate

    return car
